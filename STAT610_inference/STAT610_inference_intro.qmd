---
title: "STAT 610 â€“ Introduction to Statistical Inference (Bootcamp)"
author: "Dr. Mighty Itauma"
format:
  html:
    toc: true
    code-fold: true
    df-print: paged
jupyter: python3
---

## Simulation of LLN and CLT for Systolic Blood Pressure

```{python}
import numpy as np
import matplotlib.pyplot as plt

np.random.seed(42)

# Suppose true systolic BP in a population ~ Normal(120, 15^2)
mu = 120
sigma = 15

def simulate_sample_means(n, n_rep=5000):
    means = []
    for _ in range(n_rep):
        sample = np.random.normal(mu, sigma, size=n)
        means.append(np.mean(sample))
    return np.array(means)

sample_sizes = [5, 20, 100]

for n in sample_sizes:
    means = simulate_sample_means(n)
    print(f"n = {n}: mean of sample means = {means.mean():.2f}, sd = {means.std():.2f}")
    
    plt.figure()
    plt.hist(means, bins=40, density=True)
    plt.title(f"Sampling distribution of mean SBP (n={n})")
    plt.xlabel("Sample mean SBP")
    plt.ylabel("Density")
    plt.show()

```


## Comparing Estimators: Sample Mean vs First Observation

```{python}
import numpy as np

np.random.seed(123)

mu = 120
sigma = 15
n = 10          # sample size
n_rep = 10000   # number of simulations

means = []
first_obs = []

for _ in range(n_rep):
    sample = np.random.normal(mu, sigma, size=n)
    means.append(np.mean(sample))
    first_obs.append(sample[0])

means = np.array(means)
first_obs = np.array(first_obs)

# Compute empirical bias, variance, and MSE
def summarize(estimates, true):
    bias = np.mean(estimates) - true
    var = np.var(estimates, ddof=0)
    mse = np.mean((estimates - true)**2)
    return bias, var, mse

bias_mean, var_mean, mse_mean = summarize(means, mu)
bias_first, var_first, mse_first = summarize(first_obs, mu)

print("Sample mean estimator:")
print(f"  Bias = {bias_mean:.3f}")
print(f"  Var  = {var_mean:.3f}")
print(f"  MSE  = {mse_mean:.3f}")

print("\nFirst observation estimator:")
print(f"  Bias = {bias_first:.3f}")
print(f"  Var  = {var_first:.3f}")
print(f"  MSE  = {mse_first:.3f}")

```